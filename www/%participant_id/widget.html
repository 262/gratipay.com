from gittip import AMOUNTS, get_tip
^L
if user.ANON:
    button_text = "Gittip"
elif user.id == path['participant_id']:
    button_text = "You!"
else:
    button_text = get_tip(user.id, path['participant_id'])
    if button_text == 0:
        button_text = "Gittip"
^L
<!doctype html>
<html>
    <head>
        <style>@import url("/assets/{{ __version__ }}/gittip.css");</style>
        <style>
            BODY {
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
            BUTTON {
                position: absolute;
                top: 0;
                left: 0;
            }
        </style>

        <!-- http://css-tricks.com/snippets/jquery/fallback-for-cdn-hosted-jquery/ -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>
            if (typeof jQuery === 'undefined')
                document.write(unescape("%3Cscript src='/assets/jquery-1.8.3.min.js'%3E%3C/script%3E"));
        </script>

        <script src="/assets/{{ __version__ }}/gittip.js"></script>
        <script>
            $(document).ready(function()
            {
                $('BUTTON').click(function()
                {
                    window.open('./');
                });
            });
        </script>
    </head>
    <body>
        <button class="small selected">{{ button_text }}</button>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-247427-33']);
          _gaq.push(['_setDomainName', '.gittip.com']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
    </body>
</html>
